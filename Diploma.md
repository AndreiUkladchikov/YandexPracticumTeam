# Дипломная работа - Система лояльности (Промо)

- Купить платную версию за N рублей.
- Купить платную версию за 0 рублей (по сути триал).
- Сделать скидку M% на покупку платной версии.
- Сделать промокод на определенный срок.
- Сделать одноразовый промокод.
- Сделать многоразовый промокод.
- Сделать "применение" промокода со стороны администратора.
- Уметь отслеживать, почему именно не прошел промокод.
- Сделать генератор промокодов

## Презентация

### Базовый функционал:
1. Открываем Django админку
2. Создаем промокод (покупка триал версии) + демонстрация видов промокодов
3. Генерируем промокоды для пользователей
- список пользователей получаем из Auth
- генератор создает список промокодов
- (?) показываем что письма с промокодами отправились пользователям

### Применение промокода и интеграция с другими сервисами:
1. Авторизуем пользователя (через Postman)
2. Делаем запрос к определенному фильму (только для подписчков) - Пустой ответ
3. Применяем промокод на триал - в Auth выставляется роль Subscriber
4. Авторизуем пользователя
5. Делаем запрос к определенному фильму (только для подписчков) - показывается, т.к. у пользователя теперь есть доступ (триал)    

## Первичная настройка и запуск:

### Film Service
- docker-compose -f docker-compose-dev.yml up -d
- Создать базу: python db_create/create_pgdb.py
- Заполнить базу данными из sqlite: python db_create/main.py
- создать схемы в Elastic: python postgres_to_es/create_etl.py
- перезапустить ETL container

API: http://localhost:8080/api/openapi

### Auth Service

ToDo: Write + Add test users 

### Notification Service 

ToDo: Write

### Promo Service

ToDo: Write

### Mock Api Calls:
- ToDo: Postman 